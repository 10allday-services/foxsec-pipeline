# Should alert from stored IP reputation
{"Timestamp": 1900000000000, "Type": "z.versions", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 6, "Pid": 3379, "Fields": {"uid": "anonymous-00000000000000000000000000000000", "remoteAddressChain": "255.255.25.25", "msg": "New version: <Version: 1.0.0> (0000001) from <FileUpload: aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa>"}}
# Should alert from stored IP reputation
{"Timestamp": 1900000000000, "Type": "z.devhub", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 6, "Pid": 5190, "Fields": {"uid": "anonymous-00001", "remoteAddressChain": "255.255.25.25", "msg": "FileUpload created: 00000000000000000000000000000000"}}

# Should alert in restriction transform
{"Timestamp": 1900000000000, "Type": "z.users", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 6, "Pid": 568, "Fields": {"uid": "anonymous-00001", "remoteAddressChain": "216.160.83.56", "msg": "Restricting request from email kurn@mozilla.com (reputation=0)"}}

# Submit aliases that correlate with the initial alias, which should result in an alert from the alias transform
{"Timestamp": 1900000000000, "Type": "accounts.verify", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 7, "Pid": 3415, "Fields": {"uid": "<anon>", "remoteAddressChain": "216.160.83.58", "msg": "Got profile {'email': 'laforge+test2@mozilla.com', 'locale': 'en,en-US', 'amrValues': ['pwd', 'email'], 'twoFactorAuthentication': False, 'uid': '00000000000000000000000000000000', 'avatar': 'https:ggfirefoxusercontent.com/00000000000000000000000000000000', 'avatarDefault': True} [0000000000000000000000000000000000000000000000000000000000000000]"}}
{"Timestamp": 1900000000000, "Type": "accounts.verify", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 7, "Pid": 3415, "Fields": {"uid": "<anon>", "remoteAddressChain": "216.160.83.59", "msg": "Got profile {'email': 'laforge+test3@mozilla.com', 'locale': 'en,en-US', 'amrValues': ['pwd', 'email'], 'twoFactorAuthentication': False, 'uid': '00000000000000000000000000000000', 'avatar': 'https:ggfirefoxusercontent.com/00000000000000000000000000000000', 'avatarDefault': True} [0000000000000000000000000000000000000000000000000000000000000000]"}}
{"Timestamp": 1900000000000, "Type": "accounts.verify", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 7, "Pid": 3415, "Fields": {"uid": "<anon>", "remoteAddressChain": "216.160.83.60", "msg": "Got profile {'email': 'laforge+test4@mozilla.com', 'locale': 'en,en-US', 'amrValues': ['pwd', 'email'], 'twoFactorAuthentication': False, 'uid': '00000000000000000000000000000000', 'avatar': 'https:ggfirefoxusercontent.com/00000000000000000000000000000000', 'avatarDefault': True} [0000000000000000000000000000000000000000000000000000000000000000]"}}
{"Timestamp": 1900000000000, "Type": "accounts.verify", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 7, "Pid": 3415, "Fields": {"uid": "<anon>", "remoteAddressChain": "216.160.83.61", "msg": "Got profile {'email': 'laforge+test5@mozilla.com', 'locale': 'en,en-US', 'amrValues': ['pwd', 'email'], 'twoFactorAuthentication': False, 'uid': '00000000000000000000000000000000', 'avatar': 'https:ggfirefoxusercontent.com/00000000000000000000000000000000', 'avatarDefault': True} [0000000000000000000000000000000000000000000000000000000000000000]"}}
{"Timestamp": 1900000000000, "Type": "accounts.verify", "Logger": "http_app_addons", "Hostname": "ip", "EnvVersion": "2.0", "Severity": 7, "Pid": 3415, "Fields": {"uid": "<anon>", "remoteAddressChain": "216.160.83.62", "msg": "Got profile {'email': 'laforge+test6@mozilla.com', 'locale': 'en,en-US', 'amrValues': ['pwd', 'email'], 'twoFactorAuthentication': False, 'uid': '00000000000000000000000000000000', 'avatar': 'https:ggfirefoxusercontent.com/00000000000000000000000000000000', 'avatarDefault': True} [0000000000000000000000000000000000000000000000000000000000000000]"}}

# Test matcher, should result in an alert for matching file parameters
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.63", "msg": "UPLOAD: '00000000000000000000000000000000_test_submission.zip' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "lwaxana@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.63", "msg": "UPLOAD: '00000000000000000000000000000000_test_submission.zip' (7499 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "lwaxana@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.63", "msg": "UPLOAD: '00000000000000000000000000000000_test_submission.zip' (7501 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "lwaxana@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.63", "msg": "UPLOAD: '00000000000000000000000000000000_another_submission.zip' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "lwaxana@mozilla.com"}}

# Test multi-submit, should result in alert, should also group submissions from above with the alert
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro1@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro2@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro3@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro4@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro5@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro6@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro7@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro8@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro9@mozilla.com"}}
{"Timestamp": 1900000000000, "Type": "z.files", "Logger": "http_app_addons", "Hostname": "ip.compute.internal", "EnvVersion": "2.0", "Severity": 6, "Pid": 3326, "Fields": {"uid": "anonymous", "remoteAddressChain": "216.160.83.64", "msg": "UPLOAD: '00000000000000000000000000000000_x.xpi' (7500 bytes) to '/mnt/efs/addons.mozilla.org/files/temp/00000000000000000000000000000000.xpi'", "email": "ro10@mozilla.com"}}

# Test IP country session analysis, should trigger alert
{"Timestamp": 1900000000000, "Type": "z.users", "Logger": "http_app_addons", "Hostname": "ip.us-west-2.compute.internal", "EnvVersion": "2.0", "Severity": 7, "Pid": 3435, "Fields": {"uid": "<anon>", "remoteAddressChain": "202.196.224.1", "msg": "User (00000000: username-00000000000000000000000000000000) logged in successfully", "email": "sevenofnine@mozilla.net"}}
{"Timestamp": 1900000000000, "Type": "z.users", "Logger": "http_app_addons", "Hostname": "ip.us-west-2.compute.internal", "EnvVersion": "2.0", "Severity": 7, "Pid": 3435, "Fields": {"uid": "<anon>", "remoteAddressChain": "202.196.224.1", "msg": "User (00000000: username-00000000000000000000000000000000) logged in successfully", "email": "sevenofnine@mozilla.net"}}
{"Timestamp": 1900000000000, "Type": "z.users", "Logger": "http_app_addons", "Hostname": "ip.us-west-2.compute.internal", "EnvVersion": "2.0", "Severity": 7, "Pid": 3435, "Fields": {"uid": "<anon>", "remoteAddressChain": "67.43.156.1", "msg": "User (00000000: username-00000000000000000000000000000000) logged in successfully", "email": "sevenofnine@mozilla.net"}}
