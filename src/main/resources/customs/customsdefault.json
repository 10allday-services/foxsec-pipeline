{
    "detectors": {
        "rl_login_failure_sourceaddress_accountid": {
            "sliding_window_length": 900,
            "sliding_window_slides": 60,
            "threshold": 3,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "loginFailure" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_SOURCEADDRESS",
                                            "SECEVENT_ACCOUNTID"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_sms_recipient": {
            "sliding_window_length": 3600,
            "sliding_window_slides": 60,
            "threshold": 5,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "sendSms" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_SMSRECIPIENT"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_sms_sourceaddress": {
            "sliding_window_length": 3600,
            "sliding_window_slides": 60,
            "threshold": 5,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "sendSms" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_SOURCEADDRESS"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_sms_accountid": {
            "sliding_window_length": 3600,
            "sliding_window_slides": 60,
            "threshold": 5,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "sendSms" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_ACCOUNTID"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_email_recipient": {
            "sliding_window_length": 900,
            "sliding_window_slides": 60,
            "threshold": 3,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "sendEmail" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_EMAILRECIPIENT"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_statuscheck": {
            "sliding_window_length": 900,
            "sliding_window_slides": 60,
            "threshold": 5,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "accountStatusCheck" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_SOURCEADDRESS"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        },
        "rl_verifycode_sourceaddress_accountid": {
            "sliding_window_length": 900,
            "sliding_window_slides": 60,
            "threshold": 10,
            "alert_suppression_length": 900,
            "filter": {
                "filters": {
                    "default": {
                        "output_with_timestamp": false,
                        "rules": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_match": [
                                            [ "SECEVENT_ACTION", "recoveryEmailVerifyCode" ]
                                        ]
                                    }
                                ]
                            }
                        ],
                        "keying": [
                            {
                                "subtype": "SECEVENT",
                                "payload_filters": [
                                    {
                                        "class": "com.mozilla.secops.parser.SecEvent",
                                        "string_selectors": [
                                            "SECEVENT_SOURCEADDRESS",
                                            "SECEVENT_ACCOUNTID"
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                }
            }
        }
    }
}
